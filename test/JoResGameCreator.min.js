function DataGenerator(a){var b="var JoResLevel = function () {";b+="this.w = "+a.data.length+"; ",b+="this.h = "+a.data[0].length+"; ",b+="this.tileSize = "+a.tileSize+"; ",b+="this.terrain_sprite ="+a.terrain_sprite+"; ",b+="this.resources = [";for(var c=0;c<a.resources.length;c++)b+=a.resources[c],c!==a.resources.length-1&&(b+=",");b+="]; ",b+="this.sprite_index = [";for(var c=0;c<a.sprite_index.length;c++){var d=a.sprite_index[c];b+="{sprite:{x:"+d.sprite.x+",y:"+d.sprite.y,b+=",w:"+d.sprite.w+",h:"+d.sprite.h+"},",b+="AABB:{x:"+d.AABB.x+",y:"+d.AABB.y,b+=",w:"+d.AABB.w+",h:"+d.AABB.h+"}",b+="}",c!==a.sprite_index.length-1&&(b+=",")}b+="]; ",b+="this.data = [\n";for(var c=0;c<a.data.length;c++){b+="\t[";for(var e=0;e<a.data[c].length;e++){b+="\t\t[";for(var f=0;f<a.data[c][e].length;f++)b+=a.data[c][e][f],f!==a.data[c][e].length-1&&(b+=",");b+="]",e!==a.data[c].length-1&&(b+=","),b+="\n"}b+="]",c!==a.data.length-1&&(b+=","),b+="\n"}return b+="]; ",b+"}"}function initWindows(){var a=document.getElementById("block_palette"),b=a.children[0],c=b.children[0],d=document.getElementById("unit_palette"),e=d.children[0],f=e.children[0],g=document.getElementById("selection_tools"),h=g.children[0],i=h.children[0],j=document.getElementById("size_alert"),k=j.children[0],l=k.children[0];initWindow(a,b,c),initWindow(d,e,f),initWindow(g,h,i),(document.body.clientHeight<600||document.body.clientWidth<800)&&(initWindow(j,k,l),j.style.display="block")}function initWindow(a,b,c){a.joRes={x:0,y:0,dragging:!1},b.onmousedown=function(b){a.joRes.x=b.offsetX,a.joRes.y=b.offsetY,a.joRes.dragging=!0,a.style.zindex=3},a.onmouseup=function(b){a.joRes.dragging=!1,a.style.zindex=1},a.onmousemove=function(b){a.joRes.dragging&&(a.style.left=b.clientX-a.joRes.x+"px",a.style.top=b.clientY-a.joRes.y+"px")},c.onclick=function(b){a.style.display="none"}}function JoResGameCreator(){this.rsc=new ResourceLoader,this.screens={loading:JoResLoad,splash:JoResSplash,levelSelect:null,settings:null};var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEQAAAAlCAYAAAD7u09NAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AwOAQAtu6IdUgAAAiVJREFUaN7tWDGugzAMdb4ycQnmLFyhh6mYCluP0S1lqjjMv0IXZi6RNX8hyIQ4CXzgF/1YqoiCndgv2H4pQJIkSRYIc01+57mOtb30/eJNX89H9PpldT8UEE45U2fZzGmp1Dius0xLpVghBLy7brUDsmlnc/XtCgCgB/AOBebLNXnpe3h3HbN/ezlR364MAJz7yKbVAACFEH8HyH+WBEgCJAGSAEmAHMBDFkuAzJEkznCO4enkJ3gcIHUzzrJUn60Nus4ykEqx4TmZdxE5DAp2Egdrg2I7HGk32lD6ls1kj11SRirFbLAN83URLEPMyupuH5Bhq15CF0vkMAEsqzuTTQuyabVs2lH/42qIDcqeTBWx8PH6wT11YPXl7ROFqFWzGkIW1a0ub0cGaOqEeZbVnRVCaMLWpCR7PR8jKPysJ+66JeNTN4dIXEpxsdX17ToePD9xCpAdyNFlov9C4Na1n5k6MrRMLZUCyHM7nSZP0o7Q/03BRUHOOtDw1WgAYIUQWN/ZrewUI3mIK+9Cn2aE3UTf0g2t5bPd1K8kSZIkKYTQkXXQXVBcxrh/2+9d795dx/A4xtZXyI1ezN6+tZfae4PwbYABoO4J9jrUuj69mPEaG8qeU8EsacNmgxBIp/yDCAfkQ3JpTodSZone1vUG78l9n/qW12zsABVsrN6evnEDAFV8qPexm9m2riBj9UI2e/j2L1vtrO2eFYBQM0iSJMnu8gON3OByW0Ib0QAAAABJRU5ErkJggg==",b="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAPCAYAAAB9YDbgAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAAL5JREFUSA3Vko0KgCAMhC16/1cuJp4ca/4sGGlg03me34YpbfQdhfXegBmsaXXYzHcZHW2BS2W9PVixpnZj4iyfg5dE9sh5CCVi5I3y0zm9hlby/PHaOuPJpZOdO3Op7lWh0jMYb7XyrJmaz8JOmUWLrDeLO3VHRp3FuVH87KthLSCYS7T2NRz0Oo81PEY66GuMeAYCg1EvMiZuaA0r1borNkBCUtYzaAGjEyEgHtNlu1mKyHzc2dWBPc3/X/sAP64pCEy0Ns8AAAAASUVORK5CYII=";this.rsc.load([{name:"JoRes_logo",path:a},{name:"JoRes_start",path:b}]),this.core=null;var c=null,d=null,e=this;this.start=function(){function a(){e.update(),frame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame,frame(a,e.core.graphics.getCanvas())}this.core=new CoreManager(16,e.rsc,"JoResGameCreator-target"),this.core.update();var b=!1,c=!1;this.rsc.whenReady(function(){b?e.build(0):c=!0}),this.screen("splash",function(){c?e.build(0):b=!0}),a()},this.update=function(){"function"==typeof this.core.applicationStateChange?(this.core.applicationStateChange(this),this.core.applicationStateChange=null):this.core.update()},this.build=function(a){this.core.close(),this.screen("loading"),this.rsc.load(this.getLevelPath(a)),this.rsc.whenReady(function(){e.core.component=new LevelCreator(e.unit_list),e.rsc.load(e.core.component.resources),e.rsc.whenReady(function(){e.core.init()})})},this.screen=function(a,b){this.core.close();var c=new this.screens[a](b);c.init(this.core.public()),this.core.graphics.addTask(c),this.core.camera.setFocusObj({x:0,y:0}),this.core.component=c},this.unit_list=[],this.addUnit=function(a){this.unit_list.push(a)},this.quit=function(){this.core.close()},this.setLevelPath=function(a){c=a},this.load=function(a){this.rsc.load(a)},this.setImgPath=function(a){d=a},this.getLevelPath=function(a){return c.replace("*",a)}}function LevelCreator(){var a=new Universe;return a.resources.push("button_1.png"),a.nav=new LevelCreatorNav,a.init=function(a,b){this.nav.init(a,b,this.wizard),b.addTask(new LevelGraphics(a)),b.addTask(this.nav),b.disableDebug(),a.getCamera().setFocusObj(this.wizard),a.getCamera().setScaleBounds(1,2),a.getCamera().setTileSize(this.tileSize);for(var c=0;c<this.unit_data.length;c++)this.unit_data[c]>0&&this.addUnit(this.unit_data[c]-1,c*this.tileSize,c)},a.wizard={x:0,y:0,pos:{x:0,y:0},speed:2,brush:0,update:function(a){var b=a.getController();b.a&&(this.x-=this.speed),b.d&&(this.x+=this.speed),b.w&&(this.y-=this.speed),b.s&&(this.y+=this.speed);var c=b.current;if(null!==c){var d=a.getCamera();this.pos.x=Math.trunc((c.offsetX/2+d.x)/a.getUniverse().tileSize),this.pos.y=Math.trunc((c.offsetY/2+d.y)/a.getUniverse().tileSize)}if(b.space){var e=window.open();e.document.open(),e.document.write("<html>"+DataGenerator(a.getUniverse())+"</html>"),e.document.close(),b.space=!1}b.isDown&&a.getUniverse().setBlock(this.pos.x,this.pos.y,this.brush)}},a.update=function(a){this.nav.update(a,this.wizard),this.wizard.update(a)},a}function LevelCreatorNav(){var a=[],b=10,c=0;this.init=function(d,e){var f=d.getUniverse(),g=f.sprite_index;c=f.tileSize;for(var h=0;h<g.length;h++){var i=g[h].sprite,j=document.createElement("canvas");j.width=i.w,j.height=i.h,j.getContext("2d").drawImage(d.get(f.terrain_sprite),i.x*c,i.y*c,i.w,i.h,0,0,i.w,i.h),a.push(new Button(j,h%b*(c+1)+1,-Math.floor(h/b)*(c+1)-1,c,c,"bottom","left",h))}},this.update=function(b,c){for(var d=0;d<a.length;d++){var e=a[d].update(b);"number"==typeof e&&(c.brush=e)}},this.print=function(a,b){this.printBlockSelector(a,b)},this.printBlockSelector=function(d,e){var f=d.getCamera(),g=48;e.fillStyle="#577f63",e.fillRect(0,f.canvasHeight-(g+2),f.canvasWidth,1),e.fillStyle="#bfd8bd",e.fillRect(0,f.canvasHeight-(g+1),f.canvasWidth,g+2),e.fillStyle="#77bfa3",e.fillRect(0,f.canvasHeight-(g+1),b*(c+1)+1,g+1),e.fillStyle="#577f63",e.fillRect(b*(c+1)+1,f.canvasHeight-(g+1),1,g+1);for(var h=0;h<a.length;h++)a[h].graphics.print(d,e)}}function PaletteGraphics(){}